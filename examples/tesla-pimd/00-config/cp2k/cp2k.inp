
!!! User Setting !!!

! FUNC = PBE or PBE0
@SET FUNC PBE0

! alpha 
@SET ALPHA 0.44
@SET ONE_MINUS_ALPHA  0.56

! rVV10 b
@SET b 4.9
!!! User Setting !!!


&GLOBAL
  PROJECT bivo4-water
  RUN_TYPE ENERGY_FORCE
  PRINT_LEVEL MEDIUM
  WALLTIME 11:59:00
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &PRINT
    &FORCES ON
    &END FORCES  
  &END PRINT
  &DFT
    UKS .TRUE.
    ! CHARGE -1 ! for electron polaron
    CHARGE 1 ! for hole polaron

    BASIS_SET_FILE_NAME   BASIS_MOLOPT
    !BASIS_SET_FILE_NAME   BASIS_BIVO4
    POTENTIAL_FILE_NAME   GTH_POTENTIALS
    
    @IF ${FUNC} == PBE0
    BASIS_SET_FILE_NAME   BASIS_ADMM
    BASIS_SET_FILE_NAME   BASIS_ADMM_MOLOPT
    @ENDIF
    &MGRID
      CUTOFF 600
      REL_CUTOFF 60
    &END MGRID
    &QS
      METHOD GPW
      EPS_DEFAULT 1.0E-10
      EPS_PGF_ORB 1.0E-10
      EXTRAPOLATION ASPC
    &END QS

    @IF ${FUNC} == PBE0
    &AUXILIARY_DENSITY_MATRIX_METHOD
      METHOD BASIS_PROJECTION
      ADMM_PURIFICATION_METHOD MO_DIAG
    &END AUXILIARY_DENSITY_MATRIX_METHOD
    @ENDIF
    &SCF
      SCF_GUESS RESTART
      EPS_SCF 1.0E-5
      MAX_SCF 50
      &OT
        MINIMIZER CG
        PRECONDITIONER FULL_SINGLE_INVERSE
      &END OT
      &OUTER_SCF
        EPS_SCF 1.0E-5
        MAX_SCF 5
      &END
    &END SCF
    &LOCALIZE
      EPS_LOCALIZATION 1.0E-4
      &PRINT
        &WANNIER_CENTERS
          IONS+CENTERS .TRUE.
          FILENAME =bivo4_wannier.xyz
        &END
        &TOTAL_DIPOLE
          FILENAME =bivo4_dip_wannier
          PERIODIC
        &END
      &END PRINT
    &END LOCALIZE
    &XC
@IF ${FUNC} == PBE
    &XC_FUNCTIONAL PBE
    &END XC_FUNCTIONAL
@ENDIF
@IF ${FUNC} == PBE0
    &XC_FUNCTIONAL
      &PBE
        SCALE_X ${ONE_MINUS_ALPHA}
        SCALE_C 1.0
      &END PBE
      &PBE_HOLE_T_C_LR
        CUTOFF_RADIUS 5.0
        SCALE_X ${ALPHA}
      &END PBE_HOLE_T_C_LR
    &END XC_FUNCTIONAL
    &HF
      &SCREENING
        EPS_SCHWARZ 1.0E-6
        SCREEN_ON_INITIAL_P FALSE
      &END SCREENING
      &INTERACTION_POTENTIAL
        POTENTIAL_TYPE TRUNCATED
        CUTOFF_RADIUS 5.0
        T_C_G_DATA t_c_g.dat
      &END INTERACTION_POTENTIAL
      FRACTION ${ALPHA}
    &END HF
@ENDIF

    &vdW_POTENTIAL
      DISPERSION_FUNCTIONAL NON_LOCAL
      &NON_LOCAL
        TYPE RVV10
        PARAMETERS  ${b}  0.0093
        KERNEL_FILE_NAME  rVV10_kernel_table.dat
        CUTOFF      400
      &END NON_LOCAL
    &END vdW_POTENTIAL
  &END XC
  &PRINT
    &MO_CUBES
        WRITE_CUBE .FALSE.
        NLUMO 2
        NHOMO 2
    &END MO_CUBES
  &END PRINT
&END DFT
   &SUBSYS
@include @DATA_FILE

	 &KIND H
		 BASIS_SET DZVP-MOLOPT-SR-GTH-q1
@IF ${FUNC} == PBE0
		 BASIS_SET AUX_FIT cFIT3
@ENDIF
		 POTENTIAL GTH-PBE-q1
	 &END KIND

	 &KIND Bi
		 BASIS_SET DZVP-MOLOPT-SR-GTH-q5
@IF ${FUNC} == PBE0
		 BASIS_SET AUX_FIT cFIT6
@ENDIF
		 POTENTIAL GTH-PBE-q5
	 &END KIND
	 &KIND O
		 BASIS_SET DZVP-MOLOPT-SR-GTH-q6
@IF ${FUNC} == PBE0
		 BASIS_SET AUX_FIT cFIT3
@ENDIF
		 POTENTIAL GTH-PBE-q6
	 &END KIND
	 &KIND V
		 BASIS_SET DZVP-MOLOPT-SR-GTH-q13
@IF ${FUNC} == PBE0
		 BASIS_SET AUX_FIT cFIT10
@ENDIF
		 POTENTIAL GTH-PBE-q13
	 &END KIND
 &END SUBSYS
&END FORCE_EVAL



